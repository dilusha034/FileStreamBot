<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POP Tv One Player</title>
    <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />
    <style>
        :root { --plyr-color-main: #e50914; } /* Set player color to your brand color */
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background-color: #000; }
    </style>
</head>
<body>
    <video id="player" playsinline controls></video>

    <script src="https://cdn.plyr.io/3.7.8/plyr.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            function getQueryParam(param) {
                const urlParams = new URLSearchParams(window.location.search);
                return urlParams.get(param);
            }

            // --- Get Video & Subtitle from URL ---
            const path = "{{ path }}";
const base_url = window.location.origin;

const videoSrc = `${base_url}/${path}`;
// Since we don't have subtitle in this route, we leave it empty
const subSrc = '';
            
            // --- Plyr Player Options ---
            const playerOptions = {
                controls: [
                    'play-large', 'restart', 'rewind', 'play', 'fast-forward', 'progress', 
                    'current-time', 'duration', 'mute', 'volume', 'captions', 'settings', 
                    'pip', 'airplay', 'fullscreen'
                ],
                settings: ['captions', 'quality', 'speed', 'loop'],
                captions: { active: true, language: 'si', update: true },
                tooltips: { controls: true, seek: true }
            };

            // --- Initialize Player ---
            const player = new Plyr('#player', playerOptions);
            
            // --- Set Player Source ---
            let playerSource = {
                type: 'video',
                title: 'POP Tv One',
                sources: [
                    { src: videoSrc, type: 'video/mp4', size: 1080 },
                    // You can add more qualities here later, e.g., 720p
                    // { src: videoSrc720, type: 'video/mp4', size: 720 },
                ],
                tracks: []
            };

            if (subSrc) {
                playerSource.tracks.push({
                    kind: 'captions',
                    label: 'Sinhala',
                    srclang: 'si',
                    src: subSrc,
                    default: true,
                });
            }

            player.source = playerSource;
        });
    </script>
</body>
</html>
